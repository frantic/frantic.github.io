<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Copying Code with Syntax Highlighting / frantic.im</title>
    <meta name="author" content="Alex Kotliarskyi">
    <meta name="description" content="Occasional posts on technology and stuff">

    <link rel="canonical" href="https://frantic.im/copy-with-syntax">
    <link rel="alternate" type="application/rss+xml" title="frantic.im" href="https://frantic.im/feed.xml">

    <meta property="og:title" content="Copying Code with Syntax Highlighting">
    <meta property="og:image" content="https://frantic.im">
    <meta name="og:description" content="Occasional posts on technology and stuff">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@alex_frantic">
    <meta name="twitter:creator" content="@alex_frantic">
    <meta name="twitter:title" content="Copying Code with Syntax Highlighting">
    <meta name="twitter:description" content="Occasional posts on technology and stuff">
    <meta name="twitter:image" content="https://frantic.im">

    <link id="favicon" rel="icon" type="image/png" href="/favicon.png">
    <script>
      if ('ethereum' in window) {
        document.getElementById('favicon').href = '/assets/favicon-hex.png';
      }
    </script>

    <style type="text/css" media="screen">
      /* Typography-first theme for frantic.im (Arial-centric) */
:root {
  /* Color scheme – light */
  --background: hsl(40, 33%, 99%);
  --text: hsl(220, 20%, 18%);
  --text-secondary: hsl(220, 10%, 42%);
  --accent: hsl(220, 72%, 46%);
  --accent-underline: color-mix(in srgb, var(--accent) 60%, transparent);
  --separator: hsla(220, 20%, 90%, 0.5);

  /* Typography */
  --body-font: Arial, Helvetica, "Helvetica Neue", system-ui, -apple-system, "Segoe UI", sans-serif;
  --heading-font: var(--body-font);
  --mono-font: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;

  /* Fluid type scale */
  --step--2: clamp(0.75rem, 0.68rem + 0.2vw, 0.85rem);
  --step--1: clamp(0.9rem, 0.83rem + 0.25vw, 1rem);
  --step-0: clamp(1rem, 0.95rem + 0.35vw, 1.125rem);
  --step-1: clamp(1.20rem, 1.1rem + 0.9vw, 1.6rem);
  --step-2: clamp(1.40rem, 1.35rem + 1.2vw, 2rem);
  --step-3: clamp(1.80rem, 1.7rem + 1.8vw, 2.6rem);
  --step-4: clamp(2.40rem, 2.1rem + 2.5vw, 3.2rem);

  /* Rhythm */
  --line-height: 1.7;
  --heading-line-height: 1.25;
  --max-measure: 72ch;
  --narrow-measure: 64ch;

  /* Spacing */
  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-5: 1.5rem;
  --space-6: 2rem;
  --space-7: 3rem;
  --radius-1: 6px;
  --radius-2: 10px;

  /* Link underline */
  --underline-offset: 0.15em;
  --underline-thickness: 0.08em;

  /* Quotes */
  --open-quote: "\201C";
  --close-quote: "\201D";
  --open-quote-single: "\2018";
  --close-quote-single: "\2019";
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: hsl(223, 16%, 12%);
    --text: hsl(220, 20%, 92%);
    --text-secondary: hsl(220, 10%, 70%);
    --accent: hsl(220, 80%, 70%);
    --accent-underline: color-mix(in srgb, var(--accent) 40%, transparent);
    --separator: hsl(220, 12%, 22%);
  }
}

/* Base */
html {
  font-size: clamp(16px, 0.9rem + 0.2vw, 17px);
  box-sizing: border-box;
  hanging-punctuation: first allow-end;
  quotes: var(--open-quote) var(--close-quote) var(--open-quote-single) var(--close-quote-single);
  text-size-adjust: 100%;
}

*, *:before, *:after { box-sizing: inherit; }

body {
  background-color: var(--background);
  color: var(--text);
  font-family: var(--body-font);
  font-size: var(--step-0);
  line-height: var(--line-height);
  letter-spacing: 0.005em;
  word-spacing: 0.03em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  font-kerning: normal;
  font-variant-ligatures: common-ligatures contextual;
  font-variant-numeric: proportional-nums;
  font-variant-caps: normal;
  font-optical-sizing: auto;
  font-variation-settings: normal;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
}

/* Container */
.container {
  max-width: var(--max-measure);
  min-height: 100vh;
  margin: 0 auto;
  padding: var(--space-6) var(--space-5);
}

.container img {
  display: block;
  max-width: calc(100% + 3rem);
  height: auto;
  margin: 0 -1.5rem;
}

@media (max-width: 600px) {
  .container { padding: var(--space-5) var(--space-4); }
  .container img { max-width: calc(100% + 2rem); margin: 0 -1rem; }
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--heading-font);
  text-wrap: balance;
  font-weight: 700;
  line-height: var(--heading-line-height);
  margin: var(--space-7) 0 var(--space-5);
}

h1 { font-size: var(--step-2); letter-spacing: -0.0175em; margin-top: var(--space-6); }
h2 { font-size: var(--step-1); letter-spacing: -0.01em; }
h3 { font-size: var(--step-0); }
h4 { font-size: var(--step-0); }
h5 { font-size: var(--step-0); }
h6 { font-size: var(--step--1); font-variant-caps: small-caps; letter-spacing: 0.04em; }

p, ul, ol, dl, figure, blockquote, pre, table { margin: 0 0 var(--space-5); }

p {
  max-width: var(--max-measure);
}

.lead { font-size: var(--step-1); color: var(--text); }

small, .small { font-size: var(--step--1); color: var(--text-secondary); }

/* Header */
.site-header {
  border-bottom: 1px solid var(--separator);
  margin-bottom: var(--space-7);
  padding-bottom: var(--space-4);
  display: flex;
  gap: 0 var(--space-4);
  justify-content: space-between;
  align-items: baseline;
  flex-wrap: wrap;
}

.site-title {
  font-size: var(--step--1);
  font-weight: 700;
  margin: 0;
}

/* Navigation */
.nav {  }

.nav-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  gap: var(--space-4);
}

.nav-link {
  color: var(--text-secondary);
  text-decoration: none;
  font-size: var(--step--2);
  transition: color 0.2s ease;
  text-underline-offset: var(--underline-offset);
}

.nav-link:hover { color: var(--accent); }

/* Article */
.article { margin-bottom: calc(var(--space-7) + var(--space-4)); }

.article-title { margin-bottom: var(--space-2); color: var(--text); }

.article-title a, .site-header a { color: var(--text); text-decoration: none; }
.article-title a:hover, .site-header a:hover { text-decoration: none; }

.article-meta {
  color: var(--text-secondary);
  font-size: var(--step--1);
  margin-bottom: var(--space-5);
}

.article-content { font-size: 1rem; }

/* Inline text elements */
strong, b { font-weight: 700; }
em, i { font-style: italic; }
mark {
  background: color-mix(in srgb, var(--accent) 18%, transparent);
  color: inherit;
  padding: 0 0.15em;
  border-radius: 2px;
}

abbr[title] { text-decoration: underline dotted; text-underline-offset: 0.15em; }

sup, sub { line-height: 0; position: relative; }
sup { top: -0.3em; }
sub { bottom: -0.2em; }

/* Links */
a {
  color: var(--accent);
  text-decoration-line: underline;
  text-decoration-style: solid;
  text-decoration-color: var(--accent-underline);
  text-decoration-thickness: var(--underline-thickness);
  text-underline-offset: var(--underline-offset);
  text-decoration-skip-ink: auto;
  transition: color 120ms ease, text-decoration-color 120ms ease;
}

a:hover { text-decoration-color: currentColor; }

a:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 35%, transparent);
  border-radius: 4px;
}

/* Blockquote */
blockquote {
  border-left: 4px solid var(--separator);
  padding-left: var(--space-5);
  margin: var(--space-5) -1rem;
  color: var(--text-secondary);
  font-size: var(--step-0);
}

blockquote p { max-width: var(--narrow-measure); }

blockquote p:first-child::before { content: open-quote; margin-right: 0.1em; color: var(--text-secondary); }
blockquote p:last-child::after { content: close-quote; margin-left: 0.05em; color: var(--text-secondary); }

/* Code */
code, kbd, samp {
  font-family: var(--mono-font);
  font-size: 0.95em;
  -webkit-font-smoothing: auto;
  -moz-osx-font-smoothing: auto;
}

pre {
  font-size: var(--step--1);
  background: color-mix(in srgb, var(--text) 6%, transparent);
  padding: 16px 30px 14px;
  margin: 1em -30px;
  white-space: pre;
  word-wrap: break-word;
  font-style: normal;
  overflow-x: auto;
  tab-size: 4;
  border-radius: var(--radius-1);
  border: 1px solid var(--separator);
}

pre code { font-size: inherit; }

/* Lists */
ul, ol { padding-left: 1.3em; }

li { margin-block: 0.4em; }

li::marker { color: color-mix(in srgb, var(--text) 60%, transparent); }

/* Tables */
table {
  width: 100%;
  border-collapse: collapse;
  border-spacing: 0;
  font-variant-numeric: tabular-nums; /* aligns numbers */
}

th, td {
  padding: 0.5rem 0.75rem;
  border-bottom: 1px solid var(--separator);
  text-align: start;
}

th { color: var(--text); font-weight: 700; }

td { color: var(--text); }

/* Images, figures */
figure { margin: 0 0 var(--space-5); }

figcaption {
  font-size: var(--step--1);
  color: var(--text-secondary);
  margin-top: var(--space-2);
  text-align: start;
}

/* Subscribe section */
.subscribe-section {
  margin: 0 calc(50% - 50vw);
  padding: 4rem calc(50vw - 50%);
}

.subscribe-content { margin: 0 auto; }

.subscribe-title { font-size: var(--step-1); margin: 0 0 1rem; letter-spacing: -0.01em; }

.subscribe-text { font-size: var(--step--1) }

.subscribe-form { display: flex; gap: 1rem; margin-bottom: 1rem; }

.subscribe-input {
  flex: 1;
  padding: 0.8rem 1rem;
  font-size: var(--step--1);
  font-family: var(--body-font);
  border: 1px solid var(--separator);
  border-radius: 6px;
  background: var(--background);
  color: var(--text);
}

.subscribe-input:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 25%, transparent); }

.subscribe-button {
  padding: 0.8rem 1.25rem;
  font-size: var(--step--1);
  font-family: var(--body-font);
  font-weight: 600;
  color: var(--background);
  background: var(--text);
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: filter 0.2s ease;
}

.subscribe-button:hover { filter: brightness(1.05); }

.subscribe-footnote { font-size: var(--step--2); color: var(--text-secondary); margin: 0; }

@media (max-width: 600px) {
  .subscribe-form { flex-direction: column; }
  .subscribe-button { width: 100%; }
}

/* Footer */
.site-footer {
  margin: 0 calc(50% - 50vw);
  padding: 4rem calc(50vw - 50%);
}

.site-footer a { color: var(--text-secondary); text-decoration: none; }

.footer-inner { max-width: var(--max-measure); margin: 0 auto; }

.footer-content {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-7);
  margin-bottom: var(--space-7);
}

.footer-title { font-family: var(--heading-font); font-size: var(--step--1); margin: 0 0 1rem; font-weight: 600; }

.footer-bio { font-size: var(--step--1); line-height: 1.6; color: var(--text-secondary); margin: 0; }

.footer-heading { font-family: var(--heading-font); font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.06em; margin: 0 0 1rem; color: var(--text-secondary); }

.social-links { display: flex; flex-direction: row; gap: 0.75rem; }

.social-link {
  display: flex; justify-content: space-between; align-items: baseline;
  text-decoration: none; color: var(--text); padding: 0.5rem 0;
  border-bottom: 1px solid var(--separator);
}

.social-link:hover { color: var(--accent); text-decoration: none; }

.social-name { font-weight: 600; }

.social-handle { font-size: var(--step--1); color: var(--text-secondary); }

.social-link:hover .social-handle { color: var(--accent); }

.footer-bottom { padding-top: var(--space-6); border-top: 1px solid var(--separator); display: flex; justify-content: space-between; align-items: baseline; gap: var(--space-6); }

.footer-copyright, .footer-colophon { font-size: 0.85rem; color: var(--text-secondary); margin: 0; }

@media (max-width: 600px) {
  .footer-content { grid-template-columns: 1fr; gap: 2rem; margin-bottom: 2rem; }
  .footer-bottom { flex-direction: column; gap: 0.5rem; }
  .footer-inner { padding: 0 1rem; }
}

/* Related posts */
.related-posts { margin: var(--space-7) 0; }

.related-posts a { color: var(--text); text-decoration: none; }
.related-posts a:hover { color: var(--accent); }

.related-posts h3 { color: var(--text-secondary); font-size: var(--step--1); margin-bottom: var(--space-4); }

.related-posts ul { list-style: none; padding: 0; margin: 0; }

.related-posts li {
  font-size: var(--step-0);
  letter-spacing: -0.015em;
  font-family: var(--heading-font);
  line-height: var(--heading-line-height);
  font-weight: 700;
  margin: 1rem 0;
}

/* Year list */
.year-posts { list-style: none; padding-left: 1.5rem; margin: 0.5rem 0 1.5rem; }
.year-posts li { margin-bottom: 0.5rem; }
.year-posts a { color: var(--text-secondary); font-size: var(--step--1); text-decoration: none; }
.year-posts a:hover { color: var(--accent); text-decoration: none; }

/* Footer lists (legacy) */
.footer-section { margin-bottom: var(--space-7); }
.footer-heading { font-size: 1.2rem; margin: 0 0 1.5rem; }
.footer-list { list-style: none; padding: 0; margin: 0; }
.footer-list li { margin-bottom: 1.2rem; }
.footer-link { display: flex; justify-content: space-between; align-items: baseline; color: var(--text); text-decoration: none; }
.footer-link:hover { text-decoration: none; }
.footer-link:hover .post-title { color: var(--accent); }
.post-title { transition: color 0.2s ease; }
.post-meta, .post-count { color: var(--text-secondary); font-size: var(--step--1); }

/* Accessibility & motion */
:focus-visible { outline: 2px solid color-mix(in srgb, var(--accent) 70%, transparent); outline-offset: 3px; }

@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
}

/* Syntax highlighting tweaks (both Rouge and HLJS) */
.highlight .kd, .highlight .k { font-weight: 700; }
.highlight .mi { color: #2b6cb0; }
.highlight .cm { color: #6b7280; }

.hljs-built_in, .hljs-keyword { font-weight: 700; }
.hljs-string, .hljs-number { color: #2b6cb0; }
.hljs-comment { color: #6b7280; }

      
    </style>
  </head>

  <body>
    <div class="container">
  <header class="site-header">
  <a href="/">
    <h1 class="site-title">frantic.im</h1>
  </a>
  <nav class="nav">
    <ul class="nav-list">
      
      <li><a href="/blog" class="nav-link">Blog</a></li>
      
      <li><a href="/subscribe/" class="nav-link">Subscribe</a></li>
      
      <li><a href="/" class="nav-link">About</a></li>
      
    </ul>
  </nav>
</header>


  <main>
    <article class="article ">
      <h1 class="article-title">
        <a href="/copy-with-syntax"> Copying Code with Syntax Highlighting </a>
      </h1>
      
      <div class="article-meta">
        May 20, 2016 by Alex Kotliarskyi
      </div>
      
      <div class="article-content"><p>When preparing presentations I often want to include a few code blocks in the slides, with proper syntax highlighting. However, what sounds like a very strightforward task always turns out to be complicated.</p>
<p>You see, none of the code editors I use (Sublime Text, Atom, VSCode) preserve colorful syntax highlighting of the code. Press ⌘C/⌘V and you get only text. There are plugins for these editors that try to help with that, but what happens under the hood is completely different: they rely on <a href="http://pygments.org/">pygments</a>. This solution is not great, as it uses a different tool to actually do highlighting that produces different result.</p>
<p>For a while I’ve been using different hacks to add code to my slides:</p>
<ol>
<li>Taking a screenshot (pain to change in the future)</li>
<li>Coloring the code manually (too much work)</li>
<li>Copying the code to Github gist and then copying it from there from Safari (doesn’t have the same color scheme / syntax as my editor).</li>
</ol>
<p>Recently I came up with <a href="https://github.com/frantic/copy-with-syntax">a plugin for Atom</a>. The idea is simple: Atom’s text editor is based on web technology, which means I can just fetch the formatting information from the DOM and put it into pasteboard in a format that can be used by other apps on the system.</p>
<p><a href="https://github.com/frantic/copy-with-syntax/blob/master/lib/copy-with-syntax.js">This is how it works</a>. I look for the DOM element of the text editor and iterate over each text node recursively. I use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle">getComputedStyle</a> API to get the resulting set of styles for each node, then use that information to manually craft an RTF document with corresponding colors and font styles.</p>
<p>One interesting gotcha – some DOM nodes appear out of order, likely that’s because for performance reasons Atom splits the content into several absolutely positioned <code>div</code>s.</p>
<p>Is it pretty? Nope. Stable? Nope. Useful? Yes! <em>A typical hack</em>. The result can be found here: <a href="https://github.com/frantic/copy-with-syntax">frantic/copy-with-syntax</a>.</p>
<p>I’m sure there is a better way to do this. Both Atom and Sublime have APIs that allow you to get “scope” or “context” for each location in the text that has all information needed to do proper syntax highlighting. Maybe some day I’ll have enough curiosity to look into it.</p>
<p>P.S. Over the weekend I was experimenting with WebStorm, and it handles copying syntax-highlighted code correctly. Awesome job, JetBrains!</p>
</div>
    </article>

    






    <div class="related-posts">
      <h3>Related Posts</h3>
      <ul>
        

  

    

    
      
        
      
    
      
        
      
    

    

  

    

    
      
        
      
    
      
        
      
    

    

  

    

    
      
        
      
    

    

  

    

    
      
        
      
    

    

  

    

    

    

  

    

    

    

  

    

    
      
        
          
        
      
    

    
      <li>
        <a href="/hacker-gifts" class="footer-link">
          A Side Project Story: Hacker Gifts
        </a>
      </li>
      
      
    

  

    

    

    

  

    

    
      
        
      
    

    

  

    

    

    

  

    

    

    

  

    

    

    

  

    

    
      
        
      
    

    

  

    

    

    

  

    

    
      
        
      
    
      
        
      
    

    

  

    

    
      
        
          
        
      
    

    
      <li>
        <a href="/octave" class="footer-link">
          A Side Project Story: Octave Cloud
        </a>
      </li>
      
      
    

  

    

    

    

  

    

    

    

  

    

    

    

  

    

    

    

  

    

    

    

  

    

    

    

  

    

    

    

  

    

    
      
        
      
    
      
        
      
    
      
        
      
    

    

  

    

    
      
        
          
        
      
    
      
        
      
    

    
      <li>
        <a href="/onityper" class="footer-link">
          Digital Typewriter
        </a>
      </li>
      
      
    

  

    

    
      
        
      
    
      
        
      
    

    

  

    

    
      
        
      
    

    

  

    

    
      
        
      
    
      
        
      
    

    

  

    

    
      
        
      
    
      
        
      
    
      
        
      
    

    

  

    

    

    

  

    

    
      
        
          
        
      
    
      
        
          
        
      
    
      
        
      
    

    
      <li>
        <a href="/macos-app-shortcuts" class="footer-link">
          Better Way to Switch Between Apps on macOS
        </a>
      </li>
      
      
        


      </ul>
    </div>


  </main>

  <section class="subscribe-section">
  <div class="subscribe-content">
    <h2 class="subscribe-title">Get New Posts via Email</h2>
    <p class="subscribe-text">
      A cron job sends an email every time I publish a new blog post. Usually
      once every 2 months.
    </p>
    <form
      class="subscribe-form"
      action="https://buttondown.email/api/emails/embed-subscribe/frantic"
      method="post"
      target="popupwindow"
      onsubmit="window.open('https://buttondown.email/frantic', 'popupwindow')"
    >
      <input
        type="email"
        name="email"
        id="bd-email"
        placeholder="your@email.com"
        class="subscribe-input"
        aria-label="Email address"
      />
      <button type="submit" class="subscribe-button">Subscribe</button>
    </form>
    <p class="subscribe-footnote">
      No spam. One click to unsubscribe. Powered by
      <a href="https://buttondown.email/refer/frantic" target="_blank">
        Buttondown
      </a>
    </p>
  </div>
</section>
 <footer class="site-footer">
  <div class="footer-bottom">
    <p class="footer-copyright">
      © 2025 Alex Kotliarskyi. All rights reserved.
    </p>
    <p class="footer-colophon social-links">
      <a target="_blank" href="https://x.com/alex_frantic">Twitter</a>
      <a target="_blank" href="https://bsky.app/profile/frantic.im">Bluesky</a>
      <a target="_blank" href="https://github.com/frantic">GitHub</a>
    </p>
  </div>
</footer>

</div>

    
    <script defer src="https://u.frantic.im/script.js" data-website-id="cd2ea49a-5998-477e-8f35-a6ab8d2df514"></script>
    
  </body>
</html>
